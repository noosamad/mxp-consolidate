PROCEDURE reportScript
STARTREPORT
NOHEADERS
NOGRIDLINES
API_START
... initial list arrays used to store the COA data
DEFAULT curtransacc='6999 - Currency Translation Expense'
DEFAULT accname[1]=''
DEFAULT accsection[1]=''
DEFAULT acctype[1]=''
DEFAULT accparent[1]=''
DEFAULT accflag[1]=0
PROJECT #_apiLibrary OWNER 'gparsons'
MODEL 'CommonCOA'
... load all the data from the trasnaction model into list variables
READ MEMORY 'All'
accname=SERIES3
accsection=SERIES4
acctype=SERIES5
accparent=SERIES6
accflag=SERIES7
nritems=ITEMSINFO('accname','ITEMS')
...
... create Profit and Loss Measures List
...
mcount=0
quot='''
...loop through each account to determine the items which are DETAIL items 
... only details items need outputting as valid measures for eliminations
FOR j,1,nritems,1
    ... loop through finding all accounts belonging to this section
    WHEN lowercase(acctype[j]) EQ 'detail' and lowercase(acctype[j]) NE curtransacc
            mcount=mcount+1
            measurelist[mcount]=accname[j]
            mhide[mcount]='showData'
            mbold[mcount]=0
            mexpression[mcount]=' '    
            columnwidth 300,1-2
            TEXT measurelist[mcount]
            SAMELINE
            TEXT mexpression[mcount]
            TEXT mhide[mcount]
            DIFFERENTLINE
    ENDWHEN
ENDFOR
... Update the Elims model with the new measures
PROJECT #_apiLibrary OWNER 'gparsons'
MODEL 'Trial Balance'
TEXT 'Write Measures'
api_measure
     with dimension = 'measure'
     with option = 'ADD'
     with sourceMember = measurelist
     with expression = mexpression
     with hide = mhide
     with measureBold = mbold
ENDREPORT
API_END
RETURN
